// Check which values exist
proc freq data=work.&dataset_name;
    tables period*typ_op / missing;
    title "Check typ_op values per Pandemic Phase";
run;


// Robust Solution Anteil OP per Pandemiephase
title "Proportion of Cases with Surgery per Pandemic Phase (Robust)";
proc sql;
    select period,
           sum(case when typ_op = 1 then 1 else 0 end) as Surgery_Cases,
           count(*) as Total_Cases,
           calculated Surgery_Cases * 100.0 / calculated Total_Cases as Percent_Surgery format=6.2
    from work.&dataset_name
    group by period
    order by period;
quit;


// Proportion Female Cases

title "Proportion of Female Cases per Pandemic Phase";
proc sql;
    select period,
           sum(case when sex_grouped = 'Female' then 1 else 0 end) as Female_Cases,
           count(*) as Total_Cases,
           calculated Female_Cases * 100.0 / calculated Total_Cases as Percent_Female format=6.2
    from work.&dataset_name
    group by period
    order by period;
quit;


